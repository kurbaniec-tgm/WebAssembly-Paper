var e=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(8);return{execute(e,n){if(i&&(e=t.getNode(e[n+1]))){var s=e.transferControlToOffscreen();r.messageToWorker({12:9,13:[e._index_],38:s},[s])}return n+2}}},t=[0,1,2,3,4,5,6,7,8,9,10,11,12],r=new Map,n=(e,t)=>{t&&"value"in t&&null===t.oninput&&(t.oninput=()=>i(e,t))},s=(e,t)=>{t&&"value"in t&&!r.get(t)&&(new MutationObserver(t=>t.map(t=>i(e,t.target))).observe(t,{attributes:!0}),r.set(t,!0))},i=(e,t)=>e.messageToWorker({12:4,40:{7:t._index_,21:t.value}}),o=e=>Object.values(e).map(e=>[e.identifier,e.screenX,e.screenY,e.clientX,e.clientY,e.pageX,e.pageY,e.target._index_]),a=(e,t,r,a,u)=>{var l=[],c=u.executorsAllowed.includes(4),d=[window.innerWidth,window.innerHeight],g=e=>t=>{var n=t.currentTarget;if(n&&"value"in n)i(r,t.currentTarget);else if("resize"===t.type){var{innerWidth:s,innerHeight:a}=window;if(d[0]===s&&d[1]===a)return;d=[window.innerWidth,window.innerHeight],r.messageToWorker({12:5,40:d})}r.messageToWorker({12:1,39:{7:e,25:t.bubbles,26:t.cancelable,27:t.cancelBubble,28:[t.currentTarget._index_||0],29:t.defaultPrevented,30:t.eventPhase,31:t.isTrusted,32:t.returnValue,13:[t.target._index_||0],33:t.timeStamp,12:t.type,35:"keyCode"in t?t.keyCode:void 0,60:"pageX"in t?t.pageX:void 0,61:"pageY"in t?t.pageY:void 0,65:"offsetX"in t?t.offsetX:void 0,66:"offsetY"in t?t.offsetY:void 0,62:"touches"in t?o(t.touches):void 0,63:"changedTouches"in t?o(t.changedTouches):void 0}})};return{execute(i,o){var a=i[o+2],u=o+4+2*a;if(a=o+4+2*(i[o+3]+a),c){var d=t.getNode(i[o+1]);if(d)for(o+=4;o<a;o+=2){var h=d,f=o<=u,v=e.get(i[o]),p=i[o+1];if(h===t.baseElement)f?addEventListener(v,l[p]=g(1)):removeEventListener(v,l[p]);else{var w=null!==h.oninput,m="change"===v;f?(m&&(w=!0,h.onchange=null),h.addEventListener(v,l[p]=g(h._index_))):(m&&(w=!1),h.removeEventListener(v,l[p])),h&&"value"in h&&(w||n(r,h),s(r,h))}}}return a}}},u=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(5);return{execute(e,n){if(i&&(e=t.getNode(e[n+1]))){var s=e.getBoundingClientRect();r.messageToWorker({12:6,13:[e._index_],38:[s.top,s.right,s.bottom,s.left,s.width,s.height]})}return n+2}}},l=(e,t,r,i,o)=>{var{getNode:a}=t,u=o.executorsAllowed.includes(2);return{execute(e,t){var i=e[t+4],o=e[t+5];if(u){var l=a(e[t+1]);l&&(0<o&&e.slice(t+6+i,t+6+i+o).forEach(e=>{(e=a(e))&&e.remove()}),0<i&&e.slice(t+6,t+6+i).forEach(i=>{var o=e[t+2];(i=a(i))&&(l.insertBefore(i,o&&a(o)||null),n(r,i),s(r,i))}))}return t+6+i+o}}},c=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(0);return{execute(r,n){if(i){var o=t.getNode(r[n+1]),a=e.get(r[n+2]);r=0!==(r=r[n+4])?e.get(r-1):null,o&&null!=a&&(s.sanitizer?s.sanitizer.setAttribute(o,a,r):null==r?o.removeAttribute(a):o.setAttribute(a,r))}return n+5}}},d=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(1);return{execute(r,n){if(i){var s=t.getNode(r[n+1]);r=r[n+2],s&&r&&(s.textContent=e.get(r))}return n+3}}},g=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(3);return{execute(r,n){if(i){var o=t.getNode(r[n+1]),a=e.get(r[n+2]),u=r[n+4];r=1===r[n+3]?1===u:0!==u?e.get(u):null,o&&a&&null!=r&&(s.sanitizer?s.sanitizer.setProperty(o,a,String(r)):o[a]=r)}return n+5}}},h=(e,t,r,n,s)=>{var i,o=s.executorsAllowed.includes(6),a=0;return{execute:(e,t)=>(o&&s.longTask&&(6===e[t]?(a++,i||s.longTask(new Promise(e=>i=e))):7===e[t]&&(a--,i&&0>=a&&(i(),i=null,a=0))),t+2),get active(){return null!==i}}},f=new Float32Array(1),v=new Uint16Array(f.buffer);function p(e,t,r,n,s,i){for(var o=[],a=0;a<r;a++)switch(e[t++]){case 1:o.push(e[t++]);break;case 2:v[0]=e[t++],v[1]=e[t++],o.push(f[0]);break;case 3:o.push(n.get(e[t++]));break;case 4:var u=e[t++];t=p(e,t,u,n,s,i),o.push(t.args),t=t.offset;break;case 5:if(!i)throw Error("objectContext not provided.");o.push(i.get(e[t++]));break;case 6:u=s.getNode(e[t++]),o.push(u.getContext("2d"));break;case 7:o.push(s.getNode(e[t++]));break;default:throw Error("Cannot deserialize argument.")}return{args:o,offset:t}}var w=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(9);return{execute(r,s){var o=e.get(r[s+1]),a=r[s+2],{offset:u,args:l}=p(r,s+3,1,e,t,n);s=l[0];var{offset:c,args:d}=p(r,u,a,e,t,n);return i&&(!function e(t,r){if(!t)throw Error("Property "+r+" does not exist on "+t+".");var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"set"in n:e(Object.getPrototypeOf(t),r)}(s,o)?s[o](...d):s[o]=d[0]),c}}};var m=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(10);if(!n)throw Error("objectContext is not defined.");return{execute(r,s){var o=e.get(r[s+1]),a=r[s+2],u=r[s+3],{offset:l,args:c}=p(r,s+4,1,e,t,n);s=c[0];var{offset:d,args:g}=p(r,l,u,e,t,n);return i&&"new"!==o&&n.store(a,s[o](...g)),d}}},x=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(11);return{execute(e,n){if(i){var s=t.getNode(e[n+1]);s&&self.createImageBitmap(s).then(t=>{r.messageToWorker({12:10,73:e[n+2],38:t},[t])})}return n+3}}},y=(e,t,r,n,s)=>{var i=s.executorsAllowed.includes(12),o=(e,t)=>{s.sanitizer&&2===e&&s.sanitizer.getStorage(e,t).then(n=>{r.messageToWorker({12:11,74:t||"",75:e,21:n})})};return{execute(t,r){if(i){var n=t[r+1],a=t[r+2],u=t[r+3];if(t=t[r+4],u=0<u?e.get(u):null,t=0<t?e.get(t):null,1===n)o(a,u);else if(2===n)if(s.sanitizer)s.sanitizer.setStorage(a,u,t);else{if(0===a)var l=window.localStorage;else 1===a&&(l=window.sessionStorage);if(l)if(null==u){if(null!=t)throw Error("Unexpected storage operation.");l.clear()}else null==t?l.removeItem(u):l.setItem(u,t)}}return r+5}}};class b{constructor(t,r,n,s,i){this.mutationQueue=[],this.pendingMutations=!1,this.syncFlush=()=>{this.mutationQueue.forEach(e=>{for(var t=0,r=e.length;t<r;)t=this.executors[e[t]].execute(e,t)}),this.mutationQueue=[],this.pendingMutations=!1},this.stringContext=t,this.nodeContext=r,this.sanitizer=s.sanitizer,this.mutationPumpFunction=s.mutationPump,t=[t,r,n,i,s],r=h.apply(null,t),this.executors={2:l.apply(null,t),0:c.apply(null,t),1:d.apply(null,t),3:g.apply(null,t),4:a.apply(null,t),5:u.apply(null,t),6:r,7:r,8:e.apply(null,t),9:w.apply(null,t),10:m.apply(null,t),11:x.apply(null,t),12:y.apply(null,t)}}mutate(e,t,r,n){this.stringContext.storeValues(r),this.nodeContext.createNodes(t,this.sanitizer),this.mutationQueue=this.mutationQueue.concat(n),this.pendingMutations||(this.pendingMutations=!0,this.mutationPumpFunction(this.syncFlush,e))}}class k{constructor(e,t){this.createNodes=(e,t)=>{for(var r=(e=new Uint16Array(e)).length,n=0;n<r;n+=5){if(3===e[n+1])var s=document.createTextNode(this.stringContext.get(e[n+3]));else if(8===e[n+1])s=document.createComment(this.stringContext.get(e[n+3]));else if(11===e[n+1])s=document.createDocumentFragment();else if(s=this.stringContext.get(e[n+2]),s=0!==e[n+4]?document.createElementNS(this.stringContext.get(e[n+4]),s):document.createElement(s),t&&!t.sanitize(s))continue;this.storeNode(s,e[n])}},this.getNode=e=>(e=this.nodes.get(e))&&"BODY"===e.nodeName?this.baseElement:e,this.storeNodes=e=>{this.storeNode(e,++this.count),e.childNodes.forEach(e=>this.storeNodes(e))},this.count=2,this.stringContext=e,this.nodes=new Map([[1,t],[2,t]]),this.baseElement=t,t._index_=2,t.childNodes.forEach(e=>this.storeNodes(e))}storeNode(e,t){e._index_=t,this.nodes.set(t,e)}}class N{constructor(){this.strings=[]}get(e){return this.strings[e]||""}store(e){this.strings.push(e)}storeValues(e){e.forEach(e=>this.store(e))}}var C=[8,3];function O(e,t,r,i){var o=[].slice.call(e.childNodes).filter(r);return o={7:e._index_,11:0,0:e.nodeType,1:t(e.localName||e.nodeName),4:o.map(e=>O(e,t,r,i)),2:[].map.call(e.attributes||[],e=>[t(e.namespaceURI||"null"),t(e.name),t(e.value)])},null!=e.namespaceURI&&(o[6]=t(e.namespaceURI)),C.includes(e.nodeType)&&null!==e.textContent&&(o[5]=t(e.textContent)),n(i,e),s(i,e),o}class A{constructor(e,t,r,n,s){this.nodeContext=t,this.config=s;var{skeleton:i,strings:o}=function(e,t,r){t=t.hydrateFilter||(()=>!0);var n=[],s=new Map;return{skeleton:O(e,e=>{if(s.has(e))return s.get(e);var t=n.length;return s.set(e,t),n.push(e),t},t,r),strings:n}}(e,s,this);t=[];var a,u=[],l=s.sanitizer?s.sanitizer.getStorage(0):window.localStorage,c=s.sanitizer?s.sanitizer.getStorage(1):window.sessionStorage;for(a in e.style)t.push(a);for(var d in e)d.startsWith("on")&&u.push(d);r="'use strict';(function(){"+r+"self['window']=self;var workerDOM=WorkerThread.workerDOM;WorkerThread.hydrate(workerDOM.document,"+JSON.stringify(o)+","+JSON.stringify(i)+","+JSON.stringify(t)+","+JSON.stringify(u)+",["+window.innerWidth+","+window.innerHeight+"],"+JSON.stringify(l)+","+JSON.stringify(c)+");workerDOM.document[59](this);Object.keys(workerDOM).forEach(key => self[key]=workerDOM[key]);}).call(self);"+n+"//# sourceURL="+encodeURI(s.authorURL),this[55]=new Worker(URL.createObjectURL(new Blob([r]))),s.onCreateWorker&&s.onCreateWorker(e,o,i,t)}get worker(){return this[55]}messageToWorker(e,t){this.config.onSendMessage&&this.config.onSendMessage(e),this.worker.postMessage(e,t||[])}}class E{constructor(){this.objects=new Map}store(e,t){this.objects.set(e,t)}get(e){var t=this.objects.get(e);if(t)return t;throw Error("Object with id ("+e+") does not exist.")}}var T=[3,2];function M(e,r){return function(e,r,n){var s=new N,i=new E,o=new k(s,r),a=function(e){return Object.assign({},{mutationPump:requestAnimationFrame.bind(null),executorsAllowed:t},e)}(n);return e.then(e=>{var[t,u]=e;if(t&&u&&n.authorURL){e=new A(r,o,t,u,a);var l=new b(s,o,e,a,i);return e.worker.onmessage=e=>{var{data:t}=e;T.includes(t[12])&&(l.mutate(t[54],t[37],t[41],new Uint16Array(t[36])),n.onReceiveMessage)&&n.onReceiveMessage(e)},e.worker}return null})}(Promise.all([fetch(r.domURL).then(e=>e.text()),fetch(r.authorURL).then(e=>e.text())]),e,r)}var _=function(e,t){var r=e.getAttribute("src");return r?M(e,{authorURL:r,domURL:t}):Promise.resolve(null)};export{_ as upgradeElement};
//# sourceMappingURL=main.mjs.map
